<!DOCTYPE html>
<html>
<head>
    <title>Logout - Vilko Puota</title>
</head>
<body>
    <h1>Logging out...</h1>
    <p>Please wait while we clear your session...</p>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.0.0/firebase-app.js';
        import { getAuth, signOut } from 'https://www.gstatic.com/firebasejs/10.0.0/firebase-auth.js';

        // Firebase config
        const firebaseConfig = {
            apiKey: "AIzaSyALSEbtZpORWzNFjHLZe4YPTZr-2xa5w4U",
            authDomain: "vilko-puota.firebaseapp.com",
            projectId: "vilko-puota",
            storageBucket: "vilko-puota.firebasestorage.app",
            messagingSenderId: "136168411459",
            appId: "1:136168411459:web:098ca34dc18b6d7842dff6"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        // Clear everything
        async function clearAll() {
            try {
                // Sign out from Firebase
                await signOut(auth);
                console.log('Signed out from Firebase');

                // Clear all local storage
                localStorage.clear();
                sessionStorage.clear();
                console.log('Cleared local storage');

                // Clear any cookies
                document.cookie.split(";").forEach(function(c) {
                    document.cookie = c.replace(/^ +/, "").replace(/=.*/, "=;expires=" + new Date().toUTCString() + ";path=/");
                });

                // Wait a moment then redirect
                setTimeout(() => {
                    window.location.href = '/';
                }, 500);

            } catch (error) {
                console.error('Error during logout:', error);
                // Still redirect even if there's an error
                setTimeout(() => {
                    window.location.href = '/';
                }, 1000);
            }
        }

        // Run the logout
        clearAll();
    </script>
</body>
</html>